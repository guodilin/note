import{_ as n,o as s,c as a,e}from"./app.ca1881d0.js";const t={},i=e(`<h1 id="案例库" tabindex="-1"><a class="header-anchor" href="#案例库" aria-hidden="true">#</a> 案例库</h1><h2 id="_1-华为防火墙端口回流" tabindex="-1"><a class="header-anchor" href="#_1-华为防火墙端口回流" aria-hidden="true">#</a> 1. 华为防火墙端口回流</h2><ol><li>服务器端口映射<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nat server Monitoring-01 protocol tcp global <span class="token number">218.87</span>.139.50 <span class="token number">8001</span> inside <span class="token number">172.28</span>.0.1 <span class="token number">8000</span> no-reverse
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>服务器内网地址启动NAT<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nat-policy
rule name trust_to_untrust_monitoring    
 source-zone trust
 destination-zone untrust                
 source-address <span class="token number">172.28</span>.0.1 mask <span class="token number">255.255</span>.255.255
 action nat easy-ip
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>nat地址组</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nat address-group a1
 mode pat
 section <span class="token number">0</span> <span class="token number">1.1</span>.1.1 <span class="token number">1.1</span>.1.1   <span class="token comment"># 可以是公网不使用的地址</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>源NAT<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nat-policy
rule name monitoring
 description 内网转内网
 source-zone trust <span class="token comment"># 源</span>
 destination-zone trust <span class="token comment"># 目</span>
 source-address <span class="token number">172.26</span>.0.0 mask <span class="token number">255.255</span>.0.0 <span class="token comment"># 客户端地址</span>
 destination-address <span class="token number">172.28</span>.0.1 mask <span class="token number">255.255</span>.255.255 <span class="token comment"># 服务器地址</span>
 action nat address-group a1 <span class="token comment"># </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>安全策略<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>security-policy
rule name monitoring
 description 内网转内网
 session logging
 source-zone trust                     <span class="token comment"># 源</span>
 destination-zone trust                <span class="token comment"># 目</span>
 source-address <span class="token number">172.26</span>.0.0 mask <span class="token number">255.255</span>.0.0     <span class="token comment"># 客户端地址</span>
 destination-address <span class="token number">172.28</span>.0.1 mask <span class="token number">255.255</span>.255.255 <span class="token comment"># 服务器地址</span>
 action permit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>策略路由<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>policy-based-route                        
rule name monitoring                                
 description 内网转内网禁用策略路由                    
 ingress-interface GigabitEthernet1/0/0     <span class="token comment"># 源接口地址</span>
 source-address <span class="token number">172.26</span>.0.0 mask <span class="token number">255.255</span>.0.0    <span class="token comment"># 客户端地址</span>
 destination-address <span class="token number">172.28</span>.0.1 mask <span class="token number">255.255</span>.255.255   <span class="token comment"># 服务器地址</span>
 action no-pbr    <span class="token comment"># 不做策略路由</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="_2-vrrp配置详解" tabindex="-1"><a class="header-anchor" href="#_2-vrrp配置详解" aria-hidden="true">#</a> 2. VRRP配置详解</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">##LSW1</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>vlan <span class="token number">10</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>vlan <span class="token number">20</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif10
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.10.10 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> virtual-ip <span class="token number">192.168</span>.10.254             <span class="token comment"># 虚拟网关</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> priority <span class="token number">120</span>                          <span class="token comment"># 配置优先级，默认100</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> preempt-mode timer delay <span class="token number">0</span>           <span class="token comment"># 抢占时间0秒，默认0秒</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> track interface GigabitEthernet0/0/1    <span class="token comment"># 监听上下行口</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> track interface GigabitEthernet0/0/24   <span class="token comment"># 监听上下行口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif20
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.20.10 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>vrrp vrid <span class="token number">2</span> virtual-ip <span class="token number">192.168</span>.20.254             <span class="token comment"># 虚拟网关</span>
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>vrrp vrid <span class="token number">2</span> priority <span class="token number">115</span>                          <span class="token comment"># 配置优先级，需要低于主链路</span>
<span class="token comment">##配置接LSW3口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/1
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port link-type trunk
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port trunk allow-pass vlan <span class="token number">10</span> <span class="token number">20</span>
<span class="token comment">##配置接AR3口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif100
<span class="token punctuation">[</span>Huawei-Vlanif100<span class="token punctuation">]</span>ip address <span class="token number">172.10</span>.0.2 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/2
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port link-type access
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port default vlan <span class="token number">100</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">0.0</span>.0.0 <span class="token number">0.0</span>.0.0 <span class="token number">172.10</span>.0.1
<span class="token comment">##LSW2</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>vlan <span class="token number">10</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>vlan <span class="token number">20</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif10
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.10.20 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>vrrp vrid <span class="token number">2</span> virtual-ip <span class="token number">192.168</span>.10.254             <span class="token comment"># 虚拟网关</span>
<span class="token punctuation">[</span>Huawei-Vlanif20<span class="token punctuation">]</span>vrrp vrid <span class="token number">2</span> priority <span class="token number">115</span>                          <span class="token comment"># 配置优先级，需要低于主链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif20
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.20.20 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> virtual-ip <span class="token number">192.168</span>.20.254             <span class="token comment"># 虚拟网关</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> priority <span class="token number">120</span>                          <span class="token comment"># 配置优先级，默认100</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> preempt-mode timer delay <span class="token number">0</span>           <span class="token comment"># 抢占时间0秒，默认0秒</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> track interface GigabitEthernet0/0/1    <span class="token comment"># 监听上下行口</span>
<span class="token punctuation">[</span>Huawei-Vlanif10<span class="token punctuation">]</span>vrrp vrid <span class="token number">1</span> track interface GigabitEthernet0/0/24   <span class="token comment"># 监听上下行口</span>
<span class="token comment">##配置接LSW3口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/2
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port link-type trunk
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port trunk allow-pass vlan <span class="token number">10</span> <span class="token number">20</span>
<span class="token comment">##配置接AR3口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Vlanif100
<span class="token punctuation">[</span>Huawei-Vlanif100<span class="token punctuation">]</span>ip address <span class="token number">172.20</span>.0.2 <span class="token number">255.255</span>.255.0
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/1
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port link-type access
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port default vlan <span class="token number">10</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">0.0</span>.0.0 <span class="token number">0.0</span>.0.0 <span class="token number">172.20</span>.0.1
<span class="token comment">##LSW3</span>
<span class="token comment">##配置接LSW1口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/1
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port link-type trunk
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>port trunk allow-pass vlan <span class="token number">10</span> <span class="token number">20</span>
<span class="token comment">##配置接LSW2口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/2
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port link-type trunk
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>port trunk allow-pass vlan <span class="token number">10</span> <span class="token number">20</span>
<span class="token comment">##pc接入端</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Ethernet0/0/1
<span class="token punctuation">[</span>Huawei-Ethernet0/0/1<span class="token punctuation">]</span>port link-type access
<span class="token punctuation">[</span>Huawei-Ethernet0/0/1<span class="token punctuation">]</span>port default vlan <span class="token number">10</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Ethernet0/0/2
<span class="token punctuation">[</span>Huawei-Ethernet0/0/2<span class="token punctuation">]</span>port link-type access
<span class="token punctuation">[</span>Huawei-Ethernet0/0/2<span class="token punctuation">]</span>port default vlan <span class="token number">20</span>
<span class="token comment">##AR1</span>
<span class="token comment">##vlan10默认通过</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/0
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/0<span class="token punctuation">]</span>ip address <span class="token number">172.10</span>.0.1 <span class="token number">24</span>
<span class="token comment">##vlan20默认通过</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface GigabitEthernet0/0/1
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/0<span class="token punctuation">]</span>ip address <span class="token number">172.20</span>.0.1 <span class="token number">24</span>
<span class="token comment">##配置换回口</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface LoopBack <span class="token number">0</span>
<span class="token punctuation">[</span>Huawei-LoopBack0<span class="token punctuation">]</span>ip address <span class="token number">1.1</span>.1.1 <span class="token number">255.255</span>.255.0
<span class="token comment">##路由</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">192.168</span>.10.0 <span class="token number">255.255</span>.255.0 <span class="token number">172.10</span>.0.2
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">192.168</span>.10.0 <span class="token number">255.255</span>.255.0 <span class="token number">172.20</span>.0.2 preference <span class="token number">70</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">192.168</span>.20.0 <span class="token number">255.255</span>.255.0 <span class="token number">172.20</span>.0.2
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>ip route-static <span class="token number">192.168</span>.20.0 <span class="token number">255.255</span>.255.0 <span class="token number">172.10</span>.0.2 preference <span class="token number">70</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-海康存储服务器和华为三层交换机链路捆绑" tabindex="-1"><a class="header-anchor" href="#_3-海康存储服务器和华为三层交换机链路捆绑" aria-hidden="true">#</a> 3. 海康存储服务器和华为三层交换机链路捆绑</h2><ol><li>创建链路<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface eth-trunk <span class="token number">1</span>  <span class="token comment"># 创建链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface g0/0/1   <span class="token comment"># 进入接口</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span>   <span class="token comment"># 加入链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>int g0/0/2   <span class="token comment"># 进入接口</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/2<span class="token punctuation">]</span>eth-trunk <span class="token number">1</span>    <span class="token comment"># 加入链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>dis eth-trunk <span class="token number">1</span>    <span class="token comment"># 查询链路状态及绑定情况</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>acp priority <span class="token number">100</span>   <span class="token comment"># 设置主设备 默认接口优先级32768</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface eth-trunk <span class="token number">1</span>
<span class="token punctuation">[</span>Huawei-eth-trunk1<span class="token punctuation">]</span>max active-linknumber <span class="token number">2</span>  <span class="token comment"># 设置最大链路数</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>dis trunkmembership eth-trunk <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>链路捆绑:手工链路捆绑（两端配置需一样） 海康ROX模式<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Eth-Trunk <span class="token number">1</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>mode manual load-balance <span class="token comment"># 华为默认手工模式，LACP模式为《mode lacp-static》</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>max bandwidth-affected-linknumber <span class="token number">8</span> <span class="token comment"># 最大链路数量，默认8</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>trunkport GigabitEthernet <span class="token number">0</span>/0/1 to <span class="token number">0</span>/0/4 <span class="token comment"># 把端口G1至G4批量加入eth-trunk 1</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>quit <span class="token comment"># 退出链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display eth-trunk <span class="token number">1</span> <span class="token comment"># 查询链路状态</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>捆绑完成，所有配置在Eth-Trunk 1完成即可，和原端口配置方式一样。</p></blockquote></li><li>LACP链路捆绑（两端配置需一样） 海康802.3模式<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>interface Eth-Trunk <span class="token number">1</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>mode lacp-static <span class="token comment"># 华为LACP模式为，手工模式为mode manual load-balance</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>max bandwidth-affected-linknumber <span class="token number">8</span> <span class="token comment"># 最大链路数量，默认8《最好为2，4，8双数》</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>trunkport GigabitEthernet <span class="token number">0</span>/0/1 to <span class="token number">0</span>/0/4 <span class="token comment"># 把端口G1至G4批量加入eth-trunk 1</span>
<span class="token punctuation">[</span>Huawei-Eth-Trunk1<span class="token punctuation">]</span>quit <span class="token comment"># 退出链路</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display eth-trunk <span class="token number">1</span> <span class="token comment"># 查询链路状态</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>捆绑完成，所有配置在Eth-Trunk 1完成即可，和原端口配置方式一样。</p></blockquote></li></ol><h2 id="_4-华为路由器配置nat方法" tabindex="-1"><a class="header-anchor" href="#_4-华为路由器配置nat方法" aria-hidden="true">#</a> 4. 华为路由器配置NAT方法</h2><ol><li>静态NAT一对一<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 218.87.139.50 # 为公网ip   10.10.10.1  # 为需要上网的ip</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>nat static global <span class="token number">218.87</span>.139.50 inside <span class="token number">10.10</span>.10.1  <span class="token comment"># 出接口地址绑定</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li>PAT动态NAT一对一<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>nat address-group <span class="token number">1</span> <span class="token number">218.87</span>.139.1 <span class="token number">218.87</span>.139.50 <span class="token comment"># 创建地址池</span>
<span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>acl <span class="token number">2021</span>    <span class="token comment"># 创建id</span>
<span class="token punctuation">[</span>Huawei-acl-basic-2021<span class="token punctuation">]</span>rule <span class="token number">5</span> permit <span class="token builtin class-name">source</span> <span class="token number">10.10</span>.10.0 <span class="token number">0.0</span>.0.255  <span class="token comment"># 允许哪些段或者ip通过上网</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span> nat outbound <span class="token number">2021</span> address-group <span class="token number">1</span>     <span class="token comment"># 出接口地址绑定</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>PAT基于接口NAT一对多<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>acl <span class="token number">2021</span>                 <span class="token comment"># 创建id</span>
<span class="token punctuation">[</span>Huawei-acl-basic-2021<span class="token punctuation">]</span>rule <span class="token number">5</span> permit <span class="token builtin class-name">source</span> <span class="token number">10.10</span>.10.0 <span class="token number">0.0</span>.0.255    <span class="token comment"># 允许哪些段或者ip通过上网</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>ip address <span class="token number">218.87</span>.139.50 <span class="token number">30</span>  <span class="token comment"># 配置出接口ip外网地址</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>nat outbound <span class="token number">2021</span>    <span class="token comment"># 出口地址绑定2021上网段</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>静态PAT端口映射<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>nat server protocol tcp global current-interface <span class="token number">8808</span> inside <span class="token number">10.10</span>.10.100 <span class="token number">23</span> <span class="token comment"># 基于接口做端口映射方法1</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>nat static protocol tcp global current-interface <span class="token number">8808</span> inside <span class="token number">10.10</span>.10.100 <span class="token number">23</span> <span class="token comment"># 基于接口做端口映射方法2</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span>nat static protocol tcp global <span class="token number">218.1</span>.1.1 <span class="token number">23</span> inside <span class="token number">10.10</span>.10.100 <span class="token number">23</span> <span class="token comment"># 基于专门公网ip端口映射</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="_5-tp无线管理ac设置多ssid" tabindex="-1"><a class="header-anchor" href="#_5-tp无线管理ac设置多ssid" aria-hidden="true">#</a> 5. TP无线管理AC设置多SSID</h2><blockquote><p>设备：TL - AC500、华为交换机5720、TL-HDAP1800</p></blockquote><ol><li>配置三层交换机 <ul><li>配置网关、AC接口配置信息,10为ac和ap的vlan。20，30为SSID准备的</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">10</span>    <span class="token comment"># AC和AP</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">20</span>   <span class="token comment"># 客户wifi</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">30</span>   <span class="token comment"># 办公wifi</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>interface vlanif10
<span class="token punctuation">[</span>HUAWEI-vlanif10<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.1.254 <span class="token number">24</span>
<span class="token punctuation">[</span>HUAWEI-vlanif10<span class="token punctuation">]</span>quit
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>interface GigabitEthernet0/0/24    <span class="token comment"># 对应AC接口</span>
<span class="token punctuation">[</span>HUAWEI-GigabitEthernet0/0/24<span class="token punctuation">]</span>port link-type hybrid
<span class="token punctuation">[</span>HUAWEI-GigabitEthernet0/0/24<span class="token punctuation">]</span>port hybrid tagged vlan <span class="token number">10</span> <span class="token number">20</span> <span class="token number">30</span>
<span class="token comment"># 配置20和30地址池，有dhpc服务器的自己配置。</span>
<span class="token comment">#  Vlan20</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>dhcp <span class="token builtin class-name">enable</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>ip pool guest   <span class="token comment"># 客户wifi</span>
<span class="token punctuation">[</span>HUAWEI-ip-pool-guest<span class="token punctuation">]</span>gateway-list <span class="token number">192.168</span>.2.254
<span class="token punctuation">[</span>HUAWEI-ip-pool-guest<span class="token punctuation">]</span>network <span class="token number">192.168</span>.2.0 mask <span class="token number">24</span>
<span class="token punctuation">[</span>HUAWEI-ip-pool-guest<span class="token punctuation">]</span>dns-list <span class="token number">202.101</span>.224.69 <span class="token number">202.101</span>.226.68
<span class="token punctuation">[</span>HUAWEI-ip-pool-guest<span class="token punctuation">]</span>quit
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>interface vlanif20
<span class="token punctuation">[</span>HUAWEI-Vlanif20<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.1.254 <span class="token number">24</span>
<span class="token punctuation">[</span>HUAWEI-Vlanif20dhcp <span class="token keyword">select</span> global
<span class="token comment">#  Vlan30</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>ip pool office   <span class="token comment"># 办公wifi</span>
<span class="token punctuation">[</span>HUAWEI-ip-pool-office<span class="token punctuation">]</span>gateway-list <span class="token number">192.168</span>.3.254
<span class="token punctuation">[</span>HUAWEI-ip-pool-office<span class="token punctuation">]</span>network <span class="token number">192.168</span>.3.0 mask <span class="token number">24</span>
<span class="token punctuation">[</span>HUAWEI-ip-pool-office<span class="token punctuation">]</span>dns-list <span class="token number">202.101</span>.224.69 <span class="token number">202.101</span>.226.68
<span class="token punctuation">[</span>HUAWEI-ip-pool-office<span class="token punctuation">]</span>quit
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>interface vlanif30
<span class="token punctuation">[</span>HUAWEI-Vlanif30<span class="token punctuation">]</span>ip address <span class="token number">192.168</span>.2.254 <span class="token number">24</span>
<span class="token punctuation">[</span>HUAWEI-Vlanif30dhcp <span class="token keyword">select</span> global
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>配置二层交换机 <ul><li>接口都放行对应的vlan 10 20 30，接口可以设置trunk或者hybrid，自行决定</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">10</span>    <span class="token comment"># AC和AP</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">20</span>   <span class="token comment"># 客户wifi</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>vlan <span class="token number">30</span>   <span class="token comment"># 办公wifi</span>
<span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span>interface Ethernet0/0/1    <span class="token comment"># 对应AP接口</span>
<span class="token punctuation">[</span>HUAWEI-Ethernet0/0/1<span class="token punctuation">]</span>port link-type hybrid
<span class="token punctuation">[</span>HUAWEI-Ethernet0/0/1<span class="token punctuation">]</span>port hybrid pvid vlan <span class="token number">10</span> <span class="token comment"># 看情况是否需要</span>
<span class="token punctuation">[</span>HUAWEI-Ethernet0/0/1<span class="token punctuation">]</span>port hybrid untagged vlan <span class="token number">10</span>
<span class="token punctuation">[</span>HUAWEI-Ethernet0/0/1<span class="token punctuation">]</span>port hybrid tagged vlan <span class="token number">20</span> <span class="token number">30</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>配置ac <ul><li>配置接口vlan <ul><li>网络设置—vlan设置—新增— vlanID（10）—端口（TAG）— 确定</li></ul></li><li>配置DHCP服务，为AP分配ip地址使用。 <ul><li>网络设置—DHCP服务—服务接口（刚设置的vlan接口名称）— 开始地址（192.168.1.1）—结束地址</li><li>(192.168.1.254)— 确定</li></ul></li><li>设置SSID,即wifi名 <ul><li>无线管理—新增—SSID（guest）—安全选项—PSK密码（wifi密码）—确定</li><li>无线管理—新增—SSID（office）—安全选项—PSK密码（wifi密码）—确定</li></ul></li><li>射频绑定 <ul><li>无线管理—SSID（guest）—射频绑定—选中ap —绑定vlan（20）—绑定</li><li>无线管理—SSID（office）—射频绑定—选中ap —绑定vlan（30）—绑定</li></ul></li></ul></li></ol><h2 id="_6-深信服ac1000路由模式连接tp-link三层交换机" tabindex="-1"><a class="header-anchor" href="#_6-深信服ac1000路由模式连接tp-link三层交换机" aria-hidden="true">#</a> 6. 深信服AC1000路由模式连接TP-LINK三层交换机</h2><ul><li>外网地址: IPV4:100.100.100.100 掩码:255.255.255.0 网关:100.100.100.254</li><li>AC1000地址 ：172.18.0.1</li><li>交换机地址：172.18.0.2</li><li>交换机网段： <ul><li>部门一：连接交换机1-10端口,对应vlan2,IP网段172.18.8.0/24</li><li>部门二：连接交换机11-15端口,对应vlan3,IP网段172.18.9.0/24</li><li>监控一：连接交换机16-20端口,对应vlan4,IP网段172.19.8.0/24</li><li>监控二：连接交换机21-24端口,对应vlan5,IP网段172.19.9.0/24</li></ul></li></ul><ol><li>AC配置 <ol><li>配置部署模式为路由模式 系统管理—&gt;网络配置—&gt;部署模式—&gt;路由模式</li><li>选择网口列表 增加 LAN网口—&gt;增加WAN网口列表 说明:有几个外网地址就增加几个WAN网口</li><li>配置LAN口 LAN网口配置,我增加的是eth0接口,所以选择eth0 IPV4:172.18.0.1/255.255.255.0</li><li>配置WAN口,且配置好网关和DNS,我增加的是eth2接口 网络地址:根据自己带宽选择,我的是独立IP地址,所以网络地址选择手动配置 IPV4:100.100.100.100/255.255.255.0 默认网关:100.100.100.254 首选DNS:223.5.5.5</li><li>配置DMZ口 DMZ口配置(默认) IPV4:10.252.252.252/255.255.255.0</li><li>配置NAT代理上网,代理内网上网 外网接口:所有WAN口 代理网段(即所有内网地址):172.18.0.0/255.255.0.0</li><li>提交配置,提示重启设置,确定</li><li>由于有多个网段,需要配置回包路由,下一跳地址为三层交换机地址 目的地:172.18.0.0 子网掩码:255.255.0.0 下一跳地址:172.18.0.2 接口设置自动即可</li><li>如果需要配置策略等,根据客户需求配置即可</li></ol></li><li>三层交换机配置 <ol><li>先修改vlan1地址 路由功能—&gt;接口—&gt;编辑(IP地址:172.18.0.2,子网掩码:255.255.255.0)</li><li>增加VLAN条目 <ol><li>VLAN—&gt;802.1Q VLAN—&gt;VLAN配置</li><li>新建—&gt;VLANID,VLAN名称</li><li>根据上面提供的配置VLAN地址和网段及接口</li></ol></li><li>创建接口IP</li></ol><ul><li>路由功能—&gt;接口—&gt;编辑—&gt;创建</li><li>示例:部门一 <ul><li>VLAN接口:2</li><li>IP地址:172.18.8.254</li><li>子网掩码:255.255.255.0</li><li>其他根据要求自行设置</li></ul></li></ul><ol start="4"><li>开启DHCP地址服务器</li></ol><ul><li>全局配置里面启用DHCP服务器,点击提交</li></ul><ol start="5"><li>设置DHCP服务器地址池</li></ol><ul><li>路由功能服务器—&gt;地址池设置</li><li>示例:部门一 <ul><li>名称:部门一</li><li>网络号:172.18.8.0</li><li>开始地址:172.18.8.1</li><li>结束地址:172.18.8.253</li><li>网关地址:172.18.8.254</li><li>DNS:223.5.5.5</li><li>DNS:223.6.6.6</li></ul></li></ul><ol start="6"><li>DICP服务器地址</li></ol><ul><li>接口ID:2</li><li>服务器地址:172.18.8.254</li></ul></li></ol>`,15),p=[i];function l(c,u){return s(),a("div",null,p)}const r=n(t,[["render",l],["__file","huawei_1.html.vue"]]);export{r as default};
